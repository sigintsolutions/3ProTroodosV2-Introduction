{
  "widgetsBundle": {
    "alias": "custom",
    "title": "Custom",
    "image": null,
    "description": null
  },
  "widgetTypes": [
    {
      "alias": "test2",
      "name": "test2",
      "image": null,
      "description": null,
      "descriptor": {
        "type": "latest",
        "sizeX": 8,
        "sizeY": 4,
        "resources": [],
        "templateHtml": " <div fxFlex fxLayout=\"column\" style=\"height: 100%;\" fxLayoutAlign=\"center stretch\">\r\n    <div>My first latest values widget.</div>\r\n    <div fxFlex fxLayout=\"row\" *ngFor=\"let dataKeyData of data\" fxLayoutAlign=\"space-around center\">\r\n        <div>{{dataKeyData.dataKey.label}}:</div>\r\n        <div>{{(dataKeyData.data[0] && dataKeyData.data[0][0]) | date : 'yyyy-MM-dd HH:mm:ss' }}</div>\r\n        <div>{{dataKeyData.data[0] && dataKeyData.data[0][1]}}</div>\r\n    </div>\r\n  </div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    height: 100%;\n    border-collapse: collapse;\n    font-weight: 100;\n    white-space: nowrap;\n    text-align: center;\n}\n\n.tbDatasource-table td {\n    padding: 1px;\n    position: relative;\n    box-sizing: border-box;\n}\n\n.tbDatasource-data-key {\n    opacity: 0.7;\n    font-weight: 400;\n    font-size: 3.500rem;\n}\n\n.tbDatasource-value {\n    font-size: 5.000rem;\n}",
        "controllerScript": "    self.onInit = function() {\r\n       self.ctx.$scope.data = self.ctx.defaultSubscription.data;\r\n    }\r\n        \r\n    self.onDataUpdated = function() {\r\n        self.ctx.detectChanges();\r\n    }",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"labelPosition\": {\n                \"title\": \"Label position\",\n                \"type\": \"string\",\n                \"default\": \"top\"\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        {\n           \"key\": \"labelPosition\",\n           \"type\": \"rc-select\",\n           \"multiple\": false,\n           \"items\": [\n               {\n                   \"value\": \"top\",\n                   \"label\": \"Top\"\n               }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Temp\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.2392660816082064,\"funcBody\":\"var value = prevValue + Math.random() * 40 - 20;\\nif (value < -60) {\\n\\tvalue = -60;\\n} else if (value > 60) {\\n\\tvalue = 60;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":false,\"backgroundColor\":\"#ff5722\",\"color\":\"rgba(255, 255, 255, 0.87)\",\"padding\":\"16px\",\"settings\":{\"labelPosition\":\"top\"},\"title\":\"test2\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"units\":\"aoeu\",\"decimals\":0,\"useDashboardTimewindow\":true,\"showLegend\":false,\"widgetStyle\":{},\"actions\":{},\"showTitleIcon\":false,\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"enableDataExport\":true}"
      }
    },
    {
      "alias": "test3",
      "name": "Custom Card",
      "image": null,
      "description": null,
      "descriptor": {
        "type": "latest",
        "sizeX": 1.5,
        "sizeY": 3.5,
        "resources": [],
        "templateHtml": "",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    height: 100%;\n    border-collapse: collapse;\n    font-weight: 100;\n    white-space: nowrap;\n    text-align: center;\n}\n\n.tbDatasource-table td {\n    padding: 1px;\n    position: relative;\n    box-sizing: border-box;\n}\n.tbDatasource-data-key {\n    opacity: 0.7;\n    font-weight: 400;\n    font-size: 3.500rem;\n}\n\n.tbDatasource-value {\n    font-size: 5.000rem;\n}\n\n",
        "controllerScript": "self.onInit = function() {\r\n\r\n    self.ctx.labelPosition = self.ctx.settings.labelPosition || 'center';\r\n    \r\n    if (self.ctx.datasources.length > 0) \r\n    {\r\n        var tbDatasource = self.ctx.datasources[0];\r\n        var datasourceId = 'tbDatasource' + 0;\r\n        self.ctx.$container.append\r\n\t\t(\r\n            \"<div id='\" + datasourceId +\r\n            \"' class='tbDatasource-container'></div>\"\r\n        );\r\n        \r\n        self.ctx.datasourceContainer = $('#' + datasourceId,\r\n            self.ctx.$container);\r\n        \r\n        var tableId = 'table' + 0;\r\n        self.ctx.datasourceContainer.append\r\n\t\t(\r\n            \"<table id='\" + tableId +\r\n            \"' class='tbDatasource-table'><col width='30%'><col width='70%'></table>\"\r\n        );\r\n        var table = $('#' + tableId, self.ctx.$container);\r\n        if (self.ctx.labelPosition === 'top') \r\n\t\t{\r\n            table.css('text-align', 'center');\r\n        }\r\n        \r\n        if (tbDatasource.dataKeys.length > 0) \r\n\t\t{\r\n            var dataKey = tbDatasource.dataKeys[0];\r\n            var labelCellId = 'labelCell' + 0;\r\n            var cellId = 'cell' + 0;\r\n            if (self.ctx.labelPosition === 'center') \r\n\t\t\t{\r\n                table.append(\r\n                    \"<tr><td class='tbDatasource-data-key' id='\" + labelCellId +\"'>\" +\r\n                    dataKey.label +\r\n                    \"</td><td class='tbDatasource-value' id='\" +\r\n                    cellId +\r\n                    \"'></td></tr>\");\r\n            } \r\n\t\t\telse \r\n\t\t\t{\r\n                table.append(\r\n                    \"<tr style='vertical-align: bottom;'><td class='tbDatasource-data-key' id='\" + labelCellId +\"'>\" +\r\n                    dataKey.label +\r\n                    \"</td></tr><tr><td class='tbDatasource-value' id='\" +\r\n                    cellId +\r\n                    \"'></td></tr>\");\r\n            }\r\n            self.ctx.labelCell = $('#' + labelCellId, table);\r\n            self.ctx.valueCell = $('#' + cellId, table);\r\n            self.ctx.valueCell.html(0 + ' ' + self.ctx.units);\r\n        }\r\n    }\r\n    \r\n    $.fn.textWidth = function()\r\n\t{\r\n        var html_org = $(this).html();\r\n        var html_calc = '<span>' + html_org + '</span>';\r\n        $(this).html(html_calc);\r\n        var width = $(this).find('span:first').width();\r\n        $(this).html(html_org);\r\n        return width;\r\n    };    \r\n    \r\n    self.onResize();\r\n};\r\n\r\nself.onDataUpdated = function() \r\n{\r\n    \r\n    function isNumber(n) \r\n\t{\r\n        return !isNaN(parseFloat(n)) && isFinite(n);\r\n    }\r\n\r\n    if (self.ctx.valueCell && self.ctx.data.length > 0) \r\n\t{\r\n        var cellData = self.ctx.data[0];\r\n        if (cellData.data.length > 0) \r\n\t\t{\r\n            var tvPair = cellData.data[cellData.data.length - 1];\r\n            var value = tvPair[1];\r\n            var txtValue;\r\n            if (isNumber(value)) \r\n\t\t\t{\r\n                var decimals = self.ctx.decimals;\r\n                var units = self.ctx.units;\r\n                if (self.ctx.datasources.length > 0 && self.ctx.datasources[0].dataKeys.length > 0) \r\n\t\t\t\t{\r\n                    dataKey = self.ctx.datasources[0].dataKeys[0];\r\n                    if (dataKey.decimals || dataKey.decimals === 0) \r\n\t\t\t\t\t{\r\n                        decimals = dataKey.decimals;\r\n                    }\r\n                    if (dataKey.units)\r\n\t\t\t\t\t{\r\n                        units = dataKey.units;\r\n                    }\r\n                }\r\n                txtValue = self.ctx.utils.formatValue(value, decimals, units, true);\r\n            } \r\n\t\t\telse \r\n\t\t\t{\r\n                txtValue = value;\r\n            }\r\n            self.ctx.valueCell.html(txtValue);\r\n            var targetWidth;\r\n            var minDelta;\r\n            if (self.ctx.labelPosition === 'center') \r\n\t\t\t{\r\n                targetWidth = self.ctx.datasourceContainer.width() - self.ctx.labelCell.width();\r\n                minDelta = self.ctx.width/16 + self.ctx.padding;\r\n            } \r\n\t\t\telse \r\n\t\t\t{\r\n                targetWidth = self.ctx.datasourceContainer.width();\r\n                minDelta = self.ctx.padding;\r\n            }\r\n            var delta = targetWidth - self.ctx.valueCell.textWidth();\r\n            var fontSize = self.ctx.valueFontSize;\r\n            if (targetWidth > minDelta) \r\n\t\t\t{\r\n                while (delta < minDelta && fontSize > 6)\r\n\t\t\t\t{\r\n                    fontSize--;\r\n                    self.ctx.valueCell.css('font-size', fontSize + 'px');\r\n                    delta = targetWidth - self.ctx.valueCell.textWidth();\r\n                }\r\n            }\r\n        }\r\n    }    \r\n    \r\n};\r\n\r\nself.onResize = function() \r\n{\r\n    var labelFontSize;\r\n    if (self.ctx.labelPosition === 'top') \r\n    {\r\n        self.ctx.padding = self.ctx.height / 20;\r\n        labelFontSize = self.ctx.height / 10;\r\n        self.ctx.valueFontSize = self.ctx.height / 2;\r\n    } \r\n  \r\n    self.ctx.padding = Math.min(12, self.ctx.padding);\r\n    \r\n    if (self.ctx.labelCell) \r\n    {\r\n       self.ctx.labelCell.css('font-size', labelFontSize + 'px');\r\n       self.ctx.labelCell.css('padding', self.ctx.padding + 'px');\r\n    }\r\n    if (self.ctx.valueCell) \r\n    {\r\n       self.ctx.valueCell.css('font-size', self.ctx.valueFontSize + 'px');\r\n       self.ctx.valueCell.css('padding', self.ctx.padding + 'px');\r\n    }    \r\n};\r\n\r\nself.typeParameters = function() \r\n{\r\n    return {\r\n        maxDatasources: 1,\r\n        maxDataKeys: 1,\r\n        singleEntity: true\r\n    };\r\n};\r\n\r\n\r\nself.onDestroy = function() {};\r\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"labelPosition\": {\n                \"title\": \"Label position\",\n                \"type\": \"string\",\n                \"default\": \"top\"\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        {\n           \"key\": \"labelPosition\",\n           \"type\": \"rc-select\",\n           \"multiple\": false,\n           \"items\": [\n               {\n                   \"value\": \"top\",\n                   \"label\": \"Top\"\n               }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Temp\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.2392660816082064,\"funcBody\":\"var value = prevValue + Math.random() * 40 - 20;\\nif (value < -60) {\\n\\tvalue = -60;\\n} else if (value > 60) {\\n\\tvalue = 60;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":false,\"backgroundColor\":\"#ff5722\",\"color\":\"rgba(255, 255, 255, 0.87)\",\"padding\":\"16px\",\"settings\":{\"labelPosition\":\"top\"},\"title\":\"Custom Card\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"units\":\"aoeu\",\"decimals\":0,\"useDashboardTimewindow\":true,\"showLegend\":false,\"widgetStyle\":{},\"actions\":{},\"showTitleIcon\":false,\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"enableDataExport\":true}"
      }
    },
    {
      "alias": "basic_timeseries",
      "name": "Timeseries Line Chart",
      "image": "data:image/png;base64,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",
      "description": "Displays changes to timeseries data over time. For example, temperature or humidity readings.",
      "descriptor": {
        "type": "timeseries",
        "sizeX": 8,
        "sizeY": 5,
        "resources": [],
        "templateHtml": "",
        "templateCss": ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
        "controllerScript": "self.onInit = function() {\n    self.ctx.flot = new TbFlot(self.ctx);\n}\n\nself.onDataUpdated = function() {\n    self.ctx.flot.update();\n}\n\nself.onResize = function() {\n    self.ctx.flot.resize();\n}\n\nself.onEditModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\nself.getSettingsSchema = function() {\n    return TbFlot.settingsSchema('graph');\n}\n\nself.getDataKeySettingsSchema = function() {\n    return TbFlot.datakeySettingsSchema(true, 'graph');\n}\n\n\n\nself.onDestroy = function() {\n    self.ctx.flot.destroy();\n}",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"Timeseries Line Chart\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null}"
      }
    },
    {
      "alias": "1_future",
      "name": "1-Future",
      "image": null,
      "description": null,
      "descriptor": {
        "type": "timeseries",
        "sizeX": 8,
        "sizeY": 5,
        "resources": [],
        "templateHtml": "",
        "templateCss": ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
        "controllerScript": "self.onInit = function() {\n    self.ctx.flot = new TbFlot(self.ctx);\n    \n    // Update timewindows for future values\n    var pastOverviewHorizon = 1440 * 60 * 1000 // In milliseconds, length of the PAST timewindow\n    var startTimeMs = Date.now() - pastOverviewHorizon; // In milliseconds\n    \n    var forecastHorizon = 1.5 * 1440 * 60 * 1000 // In milliseconds, length of the FUTURE timewindow\n    var endTimeMs = Date.now() + forecastHorizon; // In milliseconds\n    \n    self.ctx.timewindowFunctions.onUpdateTimewindow(startTimeMs, endTimeMs)\n    \n}\n\nself.onDataUpdated = function() {\n    self.ctx.flot.update();\n}\n\nself.onResize = function() {\n    self.ctx.flot.resize();\n}\n\nself.onEditModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\nself.onMobileModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\nself.getSettingsSchema = function() {\n    return TbFlot.settingsSchema('graph');\n}\n\nself.getDataKeySettingsSchema = function() {\n    return TbFlot.datakeySettingsSchema(true);\n}\n\nself.onDestroy = function() {\n    self.ctx.flot.destroy();\n}\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"1-Future\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null}"
      }
    },
    {
      "alias": "6_timeseries_with_negative_stack_s",
      "name": "6-timeseries-with-negative-stack-s",
      "image": null,
      "description": null,
      "descriptor": {
        "type": "timeseries",
        "sizeX": 8,
        "sizeY": 5,
        "resources": [
          {
            "url": "https://www.chartjs.org/dist/2.8.0/Chart.min.js"
          },
          {
            "url": "https://www.chartjs.org/samples/latest/utils.js"
          },
          {
            "url": "https://ajax.cloudflare.com/cdn-cgi/scripts/a2bd7673/cloudflare-static/rocket-loader.min.js"
          },
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js"
          }
        ],
        "templateHtml": "<div class=\"center\">\n\t<canvas id=\"canvas\"></canvas>\n</div>\n",
        "templateCss": "canvas {\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n}\n\n.center {\n  margin: auto;\n  width: 90%;\n  border: 1px solid black;\n  padding: 8px;\n}",
        "controllerScript": "// Here you must take the widget subscription variables and properly modify the config variable of the ChartJS \"Stacked (line)\" graph. The graph will then render itself!\n\n// The data[] lenght must be consistent with the widget timewindow.\n\n// The data[] fields must be retrieved from the widget datasource subscription\n\n// The data[] fields must be updated within the onDataUpdate() function with latest telemetry\n\n// SET THE INITIAL CONFIGURATION VARIABLE --> PUT AS MANY \"DATA\" ENTRIES AS THE DATASOURCES\nvar config = {\n\ttype: 'line',\n\tdata: {\n\t\tlabels: [],\n\t\tdatasets: [{\n\t\t\tlabel: '',\n\t\t\tborderColor: window.chartColors.red,\n\t\t\tbackgroundColor: window.chartColors.red,\n\t\t\tdata: [\n\t\t\t],\n\t\t}, {\n\t\t\tlabel: '',\n\t\t\tborderColor: \"#aaaaaa\",//window.chartColors.yellow,\n\t\t\tbackgroundColor:  \"#aaaaaa\",//window.chartColors.yellow,\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: window.chartColors.orange,\n\t\t\tbackgroundColor: window.chartColors.orange,\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: window.chartColors.green,\n\t\t\tbackgroundColor: window.chartColors.green,\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: window.chartColors.blue,\n\t\t\tbackgroundColor: window.chartColors.blue,\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: window.chartColors.purple,\n\t\t\tbackgroundColor: window.chartColors.purple,\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: \"#558B2F\",\n\t\t\tbackgroundColor: \"#558B2F\",\n\t\t\tdata: [\n\t\t\t],\n\t\t} , {\n\t\t\tlabel: '',\n\t\t\tborderColor: \"#1565C0\",\n\t\t\tbackgroundColor: \"#1565C0\",\n\t\t\tdata: [\n\t\t\t],\n\t\t}]\n\t}, // data\n\toptions: {\n\t\tresponsive: true,\n\t\ttitle: {\n\t\t\tdisplay: true,\n\t\t\ttext: 'Consumi e produzione energetica',\n\t\t\tfontSize: '20'\n\t\t},\n\t\ttooltips: {\n\t\t\tmode: 'index',\n\t\t},\n\t\thover: {\n\t\t\tmode: 'index',\n\t\t\tintersect: false\n\t\t},\n\t\tscales: {\n\t\t\txAxes: [{\n\t\t\t\tscaleLabel: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t\tlabelString: 'Tempo'\n\t\t\t\t},\n                ticks: {\n                    autoSkip: true,\n                    maxTicksLimit: 15\n                }\n\t\t\t}],\n\t\t\tyAxes: [{\n\t\t\t\tstacked: true,\n\t\t\t\tscaleLabel: {\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\tlabelString: '[kW]'\n\t\t\t\t}\n\t\t\t}]\n\t\t},\n\t\tlegend: {\n\t\t    display: true,\n            position: 'bottom',\n            labels: {\n                fontColor: 'black'\n            }\n        },\n        elements: {\n            point: {\n                radius: 1,\n                hoverRadius: 10,\n                pointStyle: 'cross',\n                hoverBorderColor: \"rgb(0,0,0)\",\n            }\n        }\n\t} //options\n};\n\n// Dichiaroo la variabile che conterrà il grafico\nvar grafico = null;\nself.onInit = function() {\n\n\tvar ctx = document.getElementById('canvas').getContext('2d');\n\tgrafico = new Chart(ctx, config);\n\tself.onDataUpdated();\n\t\n}\n\n// Variabile per salvare le etichette dell'asse x\nvar labels = [];\nvar months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n// Variabile per salvere i valori sugli assi y delle diverse datasources\nvar valoriPerDatasource = [];\nvar valoriSingolaDatasource = []; //variabile utilizzata per raccogliere tutti i valori di una datasource in un singolo elemento\nself.onDataUpdated = function() {\n    \n    // *** TESTS ***\n    /*\n    // First datasource name (to be used as label)\n    //alert(self.ctx.defaultSubscription.datasources[0][\"name\"]);\n    // Nome del primo tipo di timeseries/attribute della prima datasource\n    //alert(self.ctx.defaultSubscription.datasources[0][\"dataKeys\"][0][\"name\"]);\n    //alert(self.ctx.defaultSubscription.data[0]);\n    \n    //Valori dei dati ricevuti\n    console.log(\"Timestamp: \" + self.ctx.defaultSubscription.data[0].data[0][0]);\n    console.log(\"Value: \" + self.ctx.defaultSubscription.data[0].data[0][1]);\n    \n    //Numero di input\n    console.log(\"Lunghezza: \" + self.ctx.defaultSubscription.data.length);\n    \n    //Tipo di valori (es. timeseries)\n    console.log(\"Tipo: \" + self.ctx.defaultSubscription.data[0].dataKey.type);\n    \n    //Tutta la timeseries?\n    console.log(\"Lunghezza totale timeseries: \" + self.ctx.defaultSubscription.data[0].data.length);\n    //Questa è la timeseries che devi usare per impostare la variabile di configurazione del grafico ChartJS!\n    \n    //Nasce qui il problema dei timestamp (che chiameremo \"labels\" da qui in poi..)\n    //Le diverse datasources hanno timestamp diversi! Come scelgo un timestamp comune appropriato? A caso?\n    console.log(\"Timestamp data 1: \" + self.ctx.defaultSubscription.data[0].data[0][0]);\n    console.log(\"Timestamp data 2: \" + self.ctx.defaultSubscription.data[1].data[0][0]);\n    // QUESTO PROBLEMA E' RISOLTO DALLA AGGREGAZIONE FATTA DALLA TIMEWINDOW SELECTOR, POICHè ACCORPA IN AUTOMATICO LE MISURE DEL DB! IN PARTE..\n    \n    //E può capitare che ci siano anche lunghezze totali delle timeseries diverse?\n    console.log(\"Lunghezza totale timeseries 1: \" + self.ctx.defaultSubscription.data[0].data.length);\n    console.log(\"Lunghezza totale timeseries 2: \" + self.ctx.defaultSubscription.data[1].data.length);\n    // PUO' CAPITARE CHE CI SIA UNA DISCREPANZA DI 1/2 UNITA'... INIZIA A PLOTTARE DA DESTRA COSI SI VEDE MENO!\n    */\n    \n    // *** CUSTOM WIDGET ***\n    \n    labels = []; //Empty the array before beginning\n    // Inserisci le etichette sull'asse x\n    for(var i = 0; i < self.ctx.defaultSubscription.data[0].data.length ; i++){\n        etichetta = new Date(self.ctx.defaultSubscription.data[0].data[i][0]);\n        //Set the label with \"day/month hour/minute\" format\n        labels.push(etichetta.getDate() + \"/\" + months[etichetta.getMonth()] + \" \" + etichetta.getHours() + \":\" + (etichetta.getMinutes()<10?'0':'') + etichetta.getMinutes());\n    }\n    \n    valoriPerDatasource = []; //Empty the array before beginning\n    // Per ogni datasource, inserisci i valori dell'asse y\n    for (var k=0 ; k<self.ctx.defaultSubscription.data.length ; k++){\n        valoriSingolaDatasource = []; //Empty the array before beginning\n        //Inserisci tutta la timeseries della specifica datasource\n        for(var l=0; l<self.ctx.defaultSubscription.data[k].data.length; l++){\n            //LIMIT TO 3 DECIMALS\n            valoriSingolaDatasource.push(self.ctx.defaultSubscription.data[k].data[l][1].toFixed(3));\n        }\n        valoriPerDatasource.push(valoriSingolaDatasource);\n    }\n    \n    // Ora che le variabili sono pronte, devi metterle opportunamente dentro la variabile config del ChartJS\n    // AGGIORNO LE ETICHETTE SU ASSE X\n    grafico.data.labels = []; //Remove old labels\n    for(i=0; i < self.ctx.defaultSubscription.data[0].data.length ; i++){\n        grafico.data.labels.push(labels[i]);\n    }\n    \n    // AGGIORNO I VALORI\n    // Per ogni datasource aggiungo un'altra dataset nella configurazione\n    \n    /*\n    try {\n        k=0;\n        grafico.data.datasets.forEach((dataset) => {\n            dataset.label = self.ctx.defaultSubscription.datasources[k][\"name\"];\n            dataset.data = [];\n            for(l=0; l<self.ctx.defaultSubscription.data[k].data.length; l++){\n                dataset.data.push(valoriPerDatasource[k][l]);\n            }\n            k++;\n        });\n    }\n    catch(err) {\n      console.log(\"error\");\n    }\n    */\n    \n    try {\n        for(k=0; k<grafico.data.datasets.length; k++){\n            grafico.data.datasets[k].label = self.ctx.defaultSubscription.datasources[k].dataKeys[0].label + \" [kW]\";\n            grafico.data.datasets[k].data = [];\n            for(l=0; l<self.ctx.defaultSubscription.data[0].data.length; l++){\n                grafico.data.datasets[k].data.push(valoriPerDatasource[k][l]);\n            }\n        }\n    }\n    catch(err) {\n      console.log(\"error\");\n    }\n    \n    // AGGIORNO IL GRAFICO (PLOT)\n    grafico.update();\n    \n}\n\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"6-timeseries-with-negative-stack-s\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null}"
      }
    },
    {
      "alias": "7_temperature",
      "name": "7-Temperature",
      "image": null,
      "description": null,
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.rawgit.com/Mikhus/canvas-gauges/gh-pages/download/2.1.5/linear/gauge.min.js"
          }
        ],
        "templateHtml": "<div id=\"titoloTemp\">\r\n    Temperatura esterna\r\n</div>\r\n\r\n<div id=\"graficoTemp\">\r\n    <canvas id=\"canvas-id\"></canvas>\r\n</div>\r\n\r\n<div id=\"valoreTemp\">\r\n    °C\r\n</div>",
        "templateCss": "#titoloTemp{\n    margin: auto;\n    width: 60%;\n    text-align:center;\n}\n\n#graficoTemp{\n    margin: auto;\n    width: 60%;\n    text-align:center;\n    height: 80%;\n}\n\n#valoreTemp{\n    margin: auto;\n    width: 60%;\n    text-align: center;\n}",
        "controllerScript": "var gauge = null;\n\nself.onInit = function() {\n    \n    gauge = new LinearGauge({\n\t\trenderTo: 'canvas-id',\n\t\twidth: document.getElementById(\"graficoTemp\").style.width,\n\t\theight: document.getElementById(\"graficoTemp\").style.height,\n\t\tminValue: -10,\n\t\tstartAngle: 90,\n\t\tticksAngle: 180,\n\t\tvalueBox: false,\n\t\tvalueInt: 2,\n\t\tvalueDec: 2,\n\t\tmaxValue: 50,\n\t\tmajorTicks: [\n\t\t\t\"-10\",\n\t\t\t\"0\",\n\t\t\t\"10\",\n\t\t\t\"20\",\n\t\t\t\"30\",\n\t\t\t\"40\",\n\t\t\t\"50\"\n\t\t],\n\t\tminorTicks: 2,\n\t\tstrokeTicks: true,\n\t\thighlights: [\n\t\t\t{\n\t\t\t\t\"from\": 30,\n\t\t\t\t\"to\": 50,\n\t\t\t\t\"color\": \"rgba(200, 50, 50, .75)\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"from\": 10,\n\t\t\t\t\"to\": 30,\n\t\t\t\t\"color\": \"rgba(50, 150, 50, .75)\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"from\": -10,\n\t\t\t\t\"to\": 10,\n\t\t\t\t\"color\": \"rgba(200, 50, 50, .75)\"\n\t\t\t}\n\t\t],\n\t\tcolorPlate: \"#fff\",\n\t\tborderShadowWidth: 0,\n\t\tborders: false,\n\t\tneedleType: \"arrow\",\n\t\tneedleWidth: 10,\n\t\tneedleCircleSize: 7,\n\t\tneedleCircleOuter: true,\n\t\tneedleCircleInner: false,\n\t\tanimationDuration: 1000,\n\t\tanimationRule: \"linear\",\n\t\tbarWidth: 10,\n\t\tvalue: 20,\n\t\tcolorNeedle: \"yellow\"\n\t}).draw();\n\t\n\tself.onResize();\n}\n\nself.onDataUpdated = function() {\n    gauge.value = self.ctx.data[0].data[0][1];\n    document.getElementById(\"valoreTemp\").innerHTML = self.ctx.data[0].data[0][1].toFixed(2) + \" °C\";\n}\n\nself.onResize = function() {\n    \n    //Modify dimension of title and value value\n    document.getElementById(\"titoloTemp\").style.fontSize = document.getElementById(\"graficoTemp\").clientWidth/8 + \"px\";\n    document.getElementById(\"valoreTemp\").style.fontSize = document.getElementById(\"graficoTemp\").clientWidth/8 + \"px\";\n    \n    //Modify dimension of the gauge based on the width/height of the widget\n    try {\n        gauge.update({\n           width: document.getElementById(\"graficoTemp\").clientWidth,\n           height: document.getElementById(\"graficoTemp\").clientHeight\n        });\n    }\n    catch(err){\n        console.log(err.message);\n    }\n    \n}\n\nself.onDestroy = function() {\n}\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"7-Temperature\"}"
      }
    }
  ]
}